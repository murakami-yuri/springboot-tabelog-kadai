<html xmlns:th="https://www.thymeleaf.org">
	<head>
		<div th:replace="~{fragment :: meta}"></div>
		<div th:replace="~{fragment :: styles}"></div>
		<title>予約一覧</title>
	</head>
	<body>
		<div class="nagoyameshi-wrapper">
			<!-- header -->
			<div th:replace="~{fragment :: header}"></div>
			
			<!-- main -->
			<main>
				<div class="container pt-4 pb-5 nagoyameshi-container">
                     <div class="row justify-content-center">
                         <div class="col-xxl-8 col-xl-9 col-lg-10">
                             
                             <h1 class="mb-4 text-center">予約一覧</h1>
 							<div th:if="${param.reserved}" class="alert alert-info">
                                 予約が完了しました。
                             </div>
 							<div th:if="${param.canceled}" class="alert alert-info">
                                 予約を１件キャンセルしました。
                             </div>
                             <div th:if="${successMessage}" class="alert alert-info">
                                 <span th:text="${successMessage}"></span>
                             </div>
 							<div th:if="${errorMessage}" class="alert alert-danger">
                                 <span th:text="${errorMessage}"></span>
                             </div>
                             <table class="table">
                                 <thead>
                                     <tr>
                                         <th scope="col">店舗名</th>
                                         <th scope="col">予約日</th>
                                         <th scope="col">予約時間</th>
                                         <th scope="col">人数</th>
                                         <th scope="col"></th>
                                     </tr>
                                 </thead>
                                 <tbody>
                                     <tr th:each="reservation : ${reservationPage}">
                                         <td th:text="${reservation.shop.name}"></td>
                                         <td th:text="${reservation.visitDate}"></td>
                                         <td th:text="${reservation.visitTime}"></td>
                                         <td th:text="${reservation.numberOfPeople} + '人'"></td> 
                                         <td><a href="#" class="nagoyameshi-link-danger" data-bs-toggle="modal" th:data-bs-target="${'#deleteReservationModal' + reservation.id}">キャンセル</a></td>    
                                     	
                                     	<!-- 削除用モーダル -->
                                         <div class="modal fade" th:id="${'deleteReservationModal' + reservation.id}" tabindex="-1" th:aria-labelledby="${'deleteReservationModalLabel' + reservation.id}">
                                             <div class="modal-dialog">
                                                 <div class="modal-content">
                                                     <div class="modal-header">
                                                         <h5 class="modal-title" th:id="${'deleteReservationModalLabel' + reservation.id}" th:text="予約をキャンセルしてもよろしいですか？"></h5>
                                                         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
                                                     </div>
                                                     <div class="modal-footer">
                                                         <form method="post"th:action="@{/reservation/__${reservation.id}__/delete}">
                                                             <button type="submit" class="btn nagoyameshi-btn-danger text-white shadow-sm">削除</button>
                                                         </form>
                                                     </div>
                                                 </div>
                                             </div>
                                         </div>
                                     </tr>
                                 </tbody>
                             </table>
                             <!-- ページネーション -->
                             <div th:if="${reservationPage.getTotalPages() > 1}" class="d-flex justify-content-center">
                                 <nav aria-label="店舗一覧ページ">
                                     <ul class="pagination">
                                         <li class="page-item">
                                             <span th:if="${reservationPage.isFirst()}" class="page-link disabled">前</span>
                                             <a th:unless="${reservationPage.isFirst()}" th:href="@{/reservation(page = ${reservationPage.getNumber() - 1})}" class="page-link nagoyameshi-page-link">前</a>
                                         </li>
                                         <li th:each="i : ${#numbers.sequence(0, reservationPage.getTotalPages() - 1)}" class="page-item">
                                             <span th:if="${i == reservationPage.getNumber()}" class="page-link active nagoyameshi-active" th:text="${i + 1}"></span>
                                             <a th:unless="${i == reservationPage.getNumber()}" th:href="@{/reservation(page = ${i})}" class="page-link nagoyameshi-page-link" th:text="${i + 1}"></a>
                                         </li>
                                         <li class="page-item">
                                             <span th:if="${reservationPage.isLast()}" class="page-link disabled">次</span>
                                             <a th:unless="${reservationPage.isLast()}" th:href="@{/reservation(page = ${reservationPage.getNumber() + 1})}" class="page-link nagoyameshi-page-link">次</a>
                                         </li>
                                     </ul>
                                 </nav>
                             </div>
                         </div>
                      </div>
                 </div>
			</main>
             
			<!-- footer --> 
			<div th:replace="~{fragment :: footer}"></div>
		</div>
 
		<!-- Bootstrap -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
	</body>
</html>